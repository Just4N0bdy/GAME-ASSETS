import{v as B,C as H,a3 as Q,e as $,d as T,o as p,c as f,x as Z,_ as I,t as oe,W as F,B as le,a4 as z,i as N,D as y,a as e,a5 as Y,a6 as K,a7 as ce,N as U,a8 as ue,a9 as E,j as k,aa as ee,ab as V,ac as j,n as pe,g as de,X as M,ad as ve,k as me,ae as g,af as _e,ag as fe,ah as te,ai as ae,V as ye,$ as q,aj as he,ak as ge,b as A,w as x,al as ne,I as G,F as C,h as W,m as D,am as se,an as re,ao as xe,ap as X,aq as ke,Y as Se}from"./gameserver-1c2982e3.js";function Ne({disable:n,stateKey:o}={}){const c=B(!1);return o&&H(()=>o==null?void 0:o.value,()=>{c.value=!1}),Q({hoverBinding:{onMouseenter(){c.value=!0},onMouseleave(){c.value=!1}},hovered:$(()=>!(n!=null&&n.value)&&c.value)})}const be=T({__name:"AppSpacer",props:{scale:{type:Number,default:0},scaleSm:{type:Number,default:0},scaleXs:{type:Number,default:0},horizontal:{type:Boolean},vertical:{type:Boolean}},setup(n){return(o,c)=>(p(),f("div",{class:Z(["-spacer",[`-s${n.scale}`,`-s${n.scaleXs}-xs`,`-s${n.scaleSm}-sm`,{"-h":n.horizontal,"-v":n.vertical}]])},null,2))}});const we=I(be,[["__scopeId","data-v-0f410a66"],["__file","AppSpacer.vue"]]);function $e(){let n=0;const o=B([]);function c(s){oe(o.value,m=>m.id===s)}return Q({notices:o,remove:c,addNotice(s){o.value.push({id:++n,data:s})}})}let Ae=null;function ie(){return Ae??(Ae=$e())}const Be={style:{flex:"auto"}},R=48,Me=T({__name:"AppShellNoticeBase",props:{noticeId:{type:Number,required:!0},message:{type:String,required:!0},autoCloseMs:{type:Number,default:void 0,validator:n=>n===void 0||typeof n=="number"&&n>0},animDurationMs:{type:Number,default:500}},emits:{"show-transition-end":()=>!0},setup(n,{emit:o}){const{remove:c}=ie(),s=n,{noticeId:m,message:l,autoCloseMs:u,animDurationMs:t}=F(s),{hovered:h,hoverBinding:b}=Ne(),w=o;let S;const d=Date.now();let a=d+((u==null?void 0:u.value)??0),r=a-d;H([h,()=>u==null?void 0:u.value],([_,L])=>{if(L===void 0||L<=0){i();return}_?(i(),r=a-Date.now()):(a=Date.now()+r,S??(S=setTimeout(()=>{c(m.value)},r)))},{immediate:!0}),le(async()=>{await z(t.value),w("show-transition-end")});function i(){S&&(clearTimeout(S),S=void 0)}function v(){i(),c(m.value)}return(_,L)=>(p(),f("div",ye({...e(b)},{class:{"anim-fade-enter-right anim-fade-leave-right":!e(q).isXs,"anim-fade-enter-down anim-back-leave-up":e(q).isXs},style:e(he)({...e(ge)(e(t)>=0,{animationDuration:`${e(t)}ms`}),display:"inline-flex",justifyContent:"flex-end",minWidth:`${Math.min(200,e(q).width-32)}px`,maxWidth:"350px",marginBottom:"4px"})}),[N("a",{class:"fill-offset",style:y({...e(_e)(2),...e(fe),border:`${e(te).px} solid ${e(ae)}`,borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:"none",padding:"8px 12px",display:"flex",alignItems:"center"}),onClick:v},[N("div",{style:y({...e(Y),height:`${R-8}px`,width:"8px",background:e(K),marginRight:"8px",overflow:"hidden"})},[N("div",{class:Z({"_anim-progress":e(u)}),style:y({...e(Y),animationDuration:`${e(u)}ms`,animationPlayState:e(h)?"paused":"running",animationFillMode:"both",animationTimingFunction:"linear",width:"100%",height:"100%",background:e(ce)})},null,6)],4),N("div",{style:y({width:`${R}px`,height:`${R}px`,flex:"none",marginRight:"8px",position:"relative"})},[U(_.$slots,"leading",pe(de({size:R})),()=>[N("div",{class:"fill-offset",style:y({...e(ue)(),...e(E)(),borderRadius:"50%"})},[k(j,{icon:"notice",style:y({margin:0,fontSize:e(ee).px,color:e(V)})},null,8,["style"])],4)],!0)],4),N("div",Be,[N("div",null,M(e(l)),1),N("div",{style:y({color:e(V),fontSize:e(ve).px})},[U(_.$slots,"subtext",{},()=>[me(M(e(g)("Click to dismiss")),1)],!0)],4)]),k(we,{horizontal:"",scale:4})],4)],16))}});const O=I(Me,[["__scopeId","data-v-ea6763b5"],["__file","AppShellNoticeBase.vue"]]),Te=T({__name:"AppShellNoticeCreatorExperience",props:{noticeId:{type:Number,required:!0},data:{type:Object,required:!0}},setup(n){const o=n,{noticeId:c,data:s}=F(o),m=B(500),l=B({percent:0,text:0}),u=$(()=>{const d=s.value.experience.current_level_xp,a=Math.max(0,d-s.value.xpGained),r=s.value.experience.current_level;let i=r;s.value.leveledUp&&(i-=1);const v=s.value.leveledUp?0:a/s.value.experience.current_level_xp_required,_=s.value.experience.is_max_level?1:d/s.value.experience.current_level_xp_required;return{currentExperience:d,currentPercent:_,currentLevel:r,previousExperience:a,previousPercent:v,previousLevel:i}}),{previousLevel:t,previousPercent:h}=u.value;l.value={percent:h,text:t};const b=$(()=>{const{leveledUp:d,experience:{current_level:a},xpGained:r}=s.value;return d?g("Level up! You are now level %{ level }.",{level:a}):g("You gained %{ xpGained } experience.",{xpGained:r})}),w=$(()=>{const d=[];return s.value.experience.is_max_level?d.push(g("You've reached the max level... for now."),g("Check your dashboard later for more rewards!")):s.value.experience.ability_on_level_up_display&&d.push(g("Next reward")+`: ${s.value.experience.ability_on_level_up_display}`),d});async function S(){const{currentLevel:d,currentPercent:a}=u.value,{experience:r,leveledUp:i,xpGained:v}=s.value,_=i?1:a;i?l.value.percent=_:l.value={percent:_,text:`+${v}xp`,styles:{fontSize:se.px,textAlign:"center"}},await z(m.value+1e3),l.value={percent:_,text:d},i&&!r.is_max_level&&(m.value=0,l.value.percent=0,await z(50),m.value=500,l.value.percent=a)}return(d,a)=>(p(),A(O,{"notice-id":e(c),message:b.value,"auto-close-ms":5e3,onShowTransitionEnd:a[0]||(a[0]=r=>S())},{leading:x(()=>[k(ne,{style:{width:"100%",height:"100%"},"transition-ms":m.value,percent:l.value.percent},{default:x(()=>[k(G,{name:"fade"},{default:x(()=>[(p(),f("span",{key:`${l.value.text}-${JSON.stringify(l.value.styles)}`,style:y(l.value.styles)},M(l.value.text),5))]),_:1})]),_:1},8,["transition-ms","percent"])]),subtext:x(()=>[w.value.length?(p(!0),f(C,{key:0},W(w.value,r=>(p(),f("div",{key:r},M(r),1))),128)):D("",!0)]),_:1},8,["notice-id","message"]))}});const Ie=I(Te,[["__scopeId","data-v-265f8fe6"],["__file","AppShellNoticeCreatorExperience.vue"]]);function P(n,o,c){return Math.min(c,Math.max(o,n))}const ze=["src","width","height","alt"],Re=T({__name:"AppStickerImg",props:{src:{type:String,required:!0},alt:{type:String,default:""},size:{type:Number,default:void 0}},setup(n){return(o,c)=>(p(),f("img",{src:n.src,width:n.size,height:n.size,alt:n.alt,draggable:"false",onmousedown:"return false;",onDragstart:c[0]||(c[0]=re(()=>{},["prevent"]))},null,40,ze))}}),Pe=I(Re,[["__file","AppStickerImg.vue"]]),J=500,Ce=T({__name:"AppShellNoticeStickerMastery",props:{noticeId:{type:Number,required:!0},data:{type:Object,required:!0}},setup(n){const o=n,{noticeId:c,data:s}=F(o),m=xe.value*2;let l;const u=$(()=>{const a=Math.max(1,s.value.max),r=P(s.value.progress,0,a),i=r>=a,v=P(r/a,0,1),_=P(v-1/a,0,1);return{progress:r,maxProgress:a,currentPercent:v,previousPercent:_,isMax:i}}),t=B({key:0,percent:u.value.previousPercent,type:"sticker"});function h(a){t.value={...a,key:t.value.key+1}}const b=$(()=>u.value.isMax?g("You mastered this sticker!"):g("You gained some progress towards mastering this sticker.")),w=$(()=>{const{progress:a,maxProgress:r,isMax:i}=u.value;return i?[g("It can be used as a reaction now.")]:[g("Place %{ count } more to master it.",{count:Math.max(1,r-a)})]});async function S(){const{currentPercent:a,isMax:r,previousPercent:i}=u.value,v=r?1:a,_=P(Math.round((a-i)*100),0,100);h(r?{percent:v,type:"jolticon",icon:"star"}:{percent:v,type:"text",text:`+${_}%`,styles:{fontSize:se.px}}),await z(J+1e3),h({percent:v,type:"sticker"})}function d(a){if((l==null?void 0:l.diameter)===a)return l.squareDimension;const r=a-m*2,i=2,v=Math.floor(Math.SQRT2*(r/2)/1)-i*2;return l={diameter:a,squareDimension:v},v}return(a,r)=>(p(),A(O,{"notice-id":e(c),message:b.value,"auto-close-ms":5e3,onShowTransitionEnd:r[0]||(r[0]=i=>S())},{leading:x(({size:i})=>[k(ne,{style:{width:"100%",height:"100%"},"transition-ms":J,percent:t.value.percent,"stroke-width":m},{default:x(()=>[k(G,{name:"fade"},{default:x(()=>[t.value.type==="text"?(p(),f("span",{key:t.value.key,style:y(t.value.styles)},M(t.value.text),5)):(p(),f("div",{key:t.value.key,style:y({width:`${d(i)}px`,height:`${d(i)}px`,...e(E)()})},[t.value.type==="sticker"?(p(),A(Pe,{key:0,src:e(s).sticker.img_url,style:{width:"100%",height:"100%"}},null,8,["src"])):(p(),A(j,{key:1,icon:t.value.icon,style:y({margin:0,fontSize:e(ee).px})},null,8,["icon","style"]))],4))]),_:2},1024)]),_:2},1032,["percent"])]),subtext:x(()=>[w.value.length?(p(!0),f(C,{key:0},W(w.value,i=>(p(),f("div",{key:i},M(i),1))),128)):D("",!0)]),_:1},8,["notice-id","message"]))}});const De=I(Ce,[["__scopeId","data-v-609f576a"],["__file","AppShellNoticeStickerMastery.vue"]]),Le={class:"shell-notice-container",style:{top:"56px",display:"grid",justifyItems:"end"}},qe=T({__name:"AppShellNotice",setup(n){const{notices:o,remove:c}=ie(),s=B(!1);async function m(){if(s.value)return;s.value=!0;const l=[...o.value],u=50;let t=0,h=0;for(const b of l)h<10&&(++h,t=u*h),setTimeout(()=>c(b.id),t);await z(t),s.value=!1}return(l,u)=>(p(),f("div",Le,[k(G,null,{default:x(()=>[e(o).length>0&&!s.value?(p(),f("a",{key:0,class:"_close anim-fade-enter-right anim-fade-leave-right",style:y({borderTopLeftRadius:e(X).px,borderBottomLeftRadius:e(X).px,backgroundColor:e(K),border:`${e(te).px} solid ${e(ae)}`,borderRight:"none",padding:"12px 16px",marginBottom:"8px",...e(E)()}),onClick:u[0]||(u[0]=re(t=>m(),["stop"]))},[k(j,{icon:"remove",style:y({margin:0,color:e(ke)})},null,8,["style"])],4)):D("",!0)]),_:1}),k(Se,null,{default:x(()=>[(p(!0),f(C,null,W(e(o),t=>(p(),f(C,{key:t.id},[t.data.type==="creator-experience"?(p(),A(Ie,{key:0,"notice-id":t.id,data:t.data},null,8,["notice-id","data"])):t.data.type==="sticker-mastery"?(p(),A(De,{key:1,"notice-id":t.id,data:t.data},null,8,["notice-id","data"])):t.data.type==="custom-message"?(p(),A(O,{key:2,"notice-id":t.id,message:t.data.message,"auto-close-ms":t.data.autoCloseMs},null,8,["notice-id","message","auto-close-ms"])):D("",!0)],64))),128))]),_:1})]))}});const Ee=I(qe,[["__scopeId","data-v-cf58264f"],["__file","AppShellNotice.vue"]]);export{Ee as default};
